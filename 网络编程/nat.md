> nat出现是为了解决ipv4地址短缺问题

### NAT关键点
- 1. 网络被分为私网和公网两个部分，NAT网关设置在私网到公网的路由出口位置，双向流量必须都要经过NAT网关；
- 2. 网络访问只能先由私网侧发起，公网无法主动访问私网主机； 
- 3. NAT网关在两个访问方向上完成两次地址的转换或翻译，出方向做源信息替换，入方向做目的信息替换； 
- 4. NAT网关的存在对通信双方是保持透明的； 
- 5. NAT网关为了实现双向翻译的功能，需要维护一张关联表，把会话的信息保存下来。

### NAT限制
- 单向通信，正如上面第二点，每个通信会话都只能是单方向发起的，这极大限制通信的能力
- 静默状态下，NAT网关会进行老化操作，会回收相关转换表资源，所以ip会话时效变短，如果应用需要维持连接的时间大于NAT网关的设置，通信就会意外中断（一般采用心跳方式解决）
- 共享ip，导致无法定位到具体那台主机，即一个IP不等于一个用户或主机
- NAT通过修改IP首部发的信息变换通信地址，它工作在网络层和传输层，无法理解应用层协议的行为，对应用层的信息是无知的

### NAT穿越技术
- 应用层网关ALG
解决NAT对应用层协议无感知的一个常用方法，缺点是更新快，或者报文被加密
- 探针技术STUN和TURN
- 中间件技术
NAT不再需要理解应用层携带的信息，只转换IP地址和端口信息
-中继代理技术
-特定协议的自穿越技术
完全不懂？？？？？？？？？？

### 总的来说
NAT阻碍主机进行P2P通信的主要原因是NAT不允许外网主机主动访问内网主机，但是P2P技术却要求通信双方都能主动发起访问，所以要在NAT网络环境中进行有效的P2P通信，就必须采用新的解决方案。



